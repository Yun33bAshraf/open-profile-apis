@page "/logout"

@using System.Security.Claims
@using IApply.Frontend.Common.Constants
@using IApply.Frontend.Models
@using IApply.Frontend.Models.Auth.Login
@using IApply.Frontend.Services
@using Microsoft.AspNetCore.Authentication
@using Microsoft.AspNetCore.Components.Authorization
@using OpenProfileAPI.Frontend.Common.Constants
@using OpenProfileAPI.Frontend.Services
@layout AuthLayout

@inject IHttpContextAccessor httpContextAccessor
@inject NavigationManager _navigationManager
@inject LoadingService LoadingService


@code {
    protected override async Task OnInitializedAsync()
    {
        await RemoveAuthStateAsync();
    }

    private async Task RemoveAuthStateAsync()
    {
        LoadingService.Show();
        await httpContextAccessor.HttpContext.SignOutAsync(Constants.AUTH_SCHEME);
        await InvokeAsync(StateHasChanged);

        _navigationManager.NavigateTo("./");
    }
}
